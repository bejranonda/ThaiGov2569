# PM Simulator 2569 (Cloudflare Edition)

A React-based simulation game where you play as the Prime Minister of Thailand, forming a coalition government and managing cabinet ministries. Refactored for deployment on Cloudflare Pages with AI and Database integration.

## Features

- **Coalition Building**: Form a government from 500 MPs.
- **Cabinet Allocation**: Assign ministries to parties based on their policies.
- **AI-Powered Chat**: Chat with your government! Responses are generated by Cloudflare Workers AI (Llama-3) based on the assigned minister's party persona.
- **Data Persistence**: Simulation results are saved to Cloudflare D1 Database.

## Prerequisites

- Node.js (v18+)
- Cloudflare Account
- Wrangler CLI (`npm install -g wrangler`)

## Setup & Development

1.  **Install Dependencies**
    ```bash
    npm install
    ```

2.  **Local Development**
    ```bash
    npm run dev
    ```
    *Note: AI and Database features require Cloudflare bindings. For full local simulation, use:*
    ```bash
    npm run preview
    ```

## Cloudflare Resources Setup

To enable the AI and Database features, you need to set up resources in your Cloudflare dashboard or via CLI.

### 1. Database (D1)

Create a new D1 database:
```bash
npx wrangler d1 create simgov2569-db
```
Copy the `database_id` from the output and paste it into `wrangler.toml`:
```toml
[[d1_databases]]
binding = "DB"
database_name = "simgov2569-db"
database_id = "YOUR_DATABASE_ID_HERE"
```

Initialize the schema:
```bash
npx wrangler d1 execute simgov2569-db --local --file=schema.sql # For local dev
npx wrangler d1 execute simgov2569-db --remote --file=schema.sql # For production
```

### 2. Workers AI

Ensure your `wrangler.toml` has the AI binding (already configured):
```toml
[ai]
binding = "AI"
```

## Deployment

Deploy to Cloudflare Pages:

```bash
npm run deploy
```

This commands builds the Vite project and deploys it using Wrangler.

## Project Structure

- `src/`: React source code (App.jsx, data.js).
- `functions/`: Cloudflare Pages Functions (API endpoints).
    - `api/chat.js`: AI Chat logic.
    - `api/stats.js`: Database interaction.
- `schema.sql`: Database schema.
